\section{The finite element method for elliptic problems}

\begin{exercise}
    Let $\Omega = (0, 1)$.
    Show that
    \begin{equation*}
        a(u, v) = \int_\Omega u \, v \ dx
    \end{equation*}
    is a bilinear form.
\end{exercise}

\begin{solution}
    To show that $a(u, v)$ is a bilinear form, we need to show that it is linear in both arguments.
    We can firstly note that
    \begin{equation*}
        a(u, v) = \int_\Omega u \, v \ dx = \int_\Omega v \, u \ dx = a(v, u),
    \end{equation*}
    showing that $a(u, v)$ is symmetric.
    We therefore only need to show that it is linear in one of the arguments.

    Let $u, v, w \in V$ and $\alpha, \beta \in \mathbb{R}$.
    Then
    \begin{align*}
        a(\alpha u + \beta v, w) &= \int_\Omega (\alpha u + \beta v) \, w \ dx \\
        &= \int_\Omega \alpha u \, w + \beta v \, w \ dx \\
        &= \alpha \int_\Omega u \, w \ dx + \beta \int_\Omega v \, w \ dx \\
        &= \alpha a(u, w) + \beta a(v, w),
    \end{align*}
    showing that $a(u, v)$ is linear in the first argument, and therefore a bilinear form.
\end{solution}

\begin{exercise}
    Let $\Omega = (0, 1)$.
    Show that
    \begin{equation*}
        a(u, v) = \int_\Omega u \, v \ dx
    \end{equation*}
    forms an inner product.
\end{exercise}

\begin{solution}
    To show that $a(u, v)$ forms an inner product, we need to show that it is symmetric, positive definite, and linear in the first argument.
    We have already shown that $a(u, v)$ is symmetric and linear in the previous exercise.
    We can also see that
    \begin{equation*}
        a(u, u) = \int_\Omega u \, u \ dx = \int_\Omega u^2 \ dx \geq 0,
    \end{equation*}
    showing that $a(u, u)$ is positive definite.
    We have therefore shown that $a(u, v)$ forms an inner product.
\end{solution}

\begin{exercise}
    Let $\Omega = (0, 1)$, then for all functions in $H^1_0(\Omega)$, Poincaré's inequality states that
    \begin{equation*}
        \norm{u}_{L^2} \leq C \norm*{\frac{\partial u}{\partial x}}_{L^2} = C \abs{u}_{H^1},
    \end{equation*}
    Use this inequality to show that the $H^1$ semi-norm defines a norm equivalent with the standard $H^1$ norm on $H^1_0(\Omega)$.
\end{exercise}

\begin{solution}
    We can use Poincaré's inequality to show that the $H^1$ semi-norm defines a norm equivalent with the standard $H^1$ norm on $H^1_0(\Omega)$.
    We have that
    \begin{equation*}
        \norm{u}_{H^1}
        = \left( \norm{u}_{L^2}^2 + \abs{u}_{H^1}^2 \right)^{1/2}
        \leq \left( C^2 \norm{\nabla u}_{L^2}^2 + \abs{u}_{H^1}^2 \right)^{1/2}
        = \sqrt{1 + C^2} \abs{u}_{H^1},
    \end{equation*}
    showing that the $H^1$ norm is bounded above by the $H^1$ semi-norm.
    We can also see that
    \begin{equation*}
        \abs{u}_{H^1}
        \leq \left( \norm{u}_{L^2}^2 + \abs{u}_{H^1}^2 \right)^{1/2}
        = \norm{u}_{H^1},
    \end{equation*}
    showing that the standard $H^1$ norm is bounded below by the $H^1$ semi-norm.
    We have therefore shown that the $H^1$ semi-norm defines a norm equivalent with the standard $H^1$ norm on $H^1_0(\Omega)$.
\end{solution}

\begin{exercise}
    Let $\Omega = (0, 1)$.
    Show that
    \begin{equation*}
        a(u, v) = \int_\Omega \nabla u \cdot \nabla v \ dx
    \end{equation*}
    forms an inner product on $H^1_0(\Omega)$ equivalent with the standard $H^1$ inner product.
\end{exercise}

\begin{solution}
    \textcolor{red!75}{What does it mean for an inner product to be equivalent with another inner product?}
    \textcolor{blue!50}{Assuming it means that two inner products are equivalent if we can bound one by the other, and vice versa.}

    \noindent
    To show that $a(u, v)$ forms an inner product on $H^1_0(\Omega)$ equivalent with the standard $H^1$ inner product, we need to show that it is symmetric, positive definite, and linear in the first argument.
    We clearly have
    \begin{equation*}
        a(u, v) = \int_\Omega \nabla u \cdot \nabla v \ dx = \int_\Omega \nabla v \cdot \nabla u \ dx = a(v, u),
    \end{equation*}
    and
    \begin{align*}
        a(\alpha u + \beta v, w)
        &= \int_\Omega \nabla (\alpha u + \beta v) \cdot \nabla w \ dx \\
        &= \int_\Omega \alpha \nabla u \cdot \nabla w + \beta \nabla v \cdot \nabla w \ dx \\
        &= \alpha \int_\Omega \nabla u \cdot \nabla w \ dx + \beta \int_\Omega \nabla v \cdot \nabla w \ dx \\
        &= \alpha a(u, w) + \beta a(v, w),
    \end{align*}
    meaning that we are only missing the positive definiteness.
    We can see that
    \begin{equation*}
        a(u, u) = \int_\Omega \nabla u \cdot \nabla u \ dx = \int_\Omega \lvert \nabla u \rvert^2 \ dx = \abs{u}_{H^1}^2 \geq 0,
    \end{equation*}
    showing that $a(u, u)$ is positive definite, and therefore forms an inner product.

    $a(u, v)$ induces the $H^1$ semi-norm, which we have already shown to be equivalent with the standard $H^1$ norm.
    We have therefore shown that $a(u, v)$ forms an inner product on $H^1_0(\Omega)$ equivalent with the standard $H^1$ inner product.
\end{solution}

\begin{exercise}
    Let $\Omega = (0, 1)$.
    Show that
    \begin{equation*}
        a(u, v) = \int_\Omega (k \nabla u) \cdot \nabla v \ dx
    \end{equation*}
    forms an inner product on $H^1_0(\Omega)$ given that $k \in \mathbb{R}^{n \times n}$ is strictly positive and bounded.
    The inner product is equivalent with the standard $H^1_0(\Omega)$ inner product.
\end{exercise}

\begin{solution}
    We begin by showing that $a(u, v)$ is symmetric.
    We have that
    \begin{align*}
        a(u, v)
        &= \int_\Omega (k \nabla u) \cdot \nabla v \ dx \\
        &= \int_\Omega (\nabla u)^T k^T \nabla v \ dx \\
        &= \int_\Omega \left( (\nabla u)^T k^T \nabla v \right)^T \ dx \\
        &= \int_\Omega (\nabla v)^T k \nabla u \ dx \\
        &= \int_\Omega k^T \nabla v \cdot \nabla u \ dx \\
        &= a(v, u),
    \end{align*}
    assuming that it is implied that $k$ is symmetric.
    Next, we show that $a(u, v)$ is linear in the first argument.
    Let $u, v, w \in H^1_0(\Omega)$ and $\alpha, \beta \in \mathbb{R}$.
    Then
    \begin{align*}
        a(\alpha u + \beta v, w)
        &= \int_\Omega (k \nabla (\alpha u + \beta v)) \cdot \nabla w \ dx \\
        &= \int_\Omega (k \alpha \nabla u + k \beta \nabla v) \cdot \nabla w \ dx \\
        &= \alpha \int_\Omega k \nabla u \cdot \nabla w \ dx + \beta \int_\Omega k \nabla v \cdot \nabla w \ dx \\
        &= \alpha a(u, w) + \beta a(v, w),
    \end{align*}
    showing that $a(u, v)$ is linear in the first argument.
    We are then just missing the positive definiteness.
    We can see that
    \begin{equation*}
        a(u, u) = \int_\Omega (k \nabla u) \cdot \nabla u \ dx = \int_\Omega (\nabla u)^T k^T \nabla u \ dx \geq \int_\Omega k_0 \abs{\nabla u}^2 \ dx \geq 0,
    \end{equation*}
    using that $k$ is strictly positive and bounded by $k_0$.

    Noting that
    \begin{equation*}
        \int_\Omega k_0 \nabla u \cdot \nabla u \ dx
        \leq \int_\Omega (k \nabla u) \cdot \nabla u \ dx
        \leq \int_\Omega k_1 \nabla u \cdot \nabla u \ dx,
    \end{equation*}
    we see that the induced norm is equivalent with the $H^1$ semi-norm, and thus also the standard $H^1_0(\Omega)$ norm.
\end{solution}

\begin{exercise}
    Make a Python code that defines a Lagrange element of arbitrary order on the reference triangle.
\end{exercise}

\begin{solution}
    In order to get a better grasp of the Lagrange elements, an illustration of the elements of order up to 4 on the reference triangle is shown in Figure~\ref{fig:lagrange_elements}, with the corresponding nodes marked in purple.

    \begin{figure}[!h]
        \centering
        \input{4_elliptic/lagrange.tex}
        \caption{Lagrange elements of order up to 4 on the reference triangle.\label{fig:lagrange_elements}}
    \end{figure}

    In order to find the Lagrange basis of order $n$, we seek to find the coefficients $a_{ij}$ such that
    \begin{equation*}
        \ell_i = \sum_{j} a_{ij} \phi_j,
    \end{equation*}
    where $\ell_i$ is the $i$th Lagrange basis function, and $\phi_j$ is the monomials, satisfying
    \begin{equation*}
        \ell_i(x_j) = \delta_{ij}.
    \end{equation*}
    We do this by solving
    \begin{equation*}
        \ell_i(x_j) = \sum_{k} a_{ik} \phi_k(x_j) = \delta_{ij},
    \end{equation*}
    or in matrix form
    \begin{equation*}
        A \Phi = I,
    \end{equation*}
    where $A$ is the matrix of coefficients, $\Phi$ is the matrix of monomials at the lagrange nodes, and $I$ is the identity matrix.
    From this, we can find the coefficients by
    \begin{equation*}
        A = \Phi^{-1}.
    \end{equation*}
    The Python code for this is available in \verb|4_elliptic/lagrange_elements.py|
\end{solution}