\section{Crash course in Sobolev Spaces}

\begin{exercise}
    What is a norm?
    Show that
    \begin{equation*}
        \lVert u \rVert_p = \left( \int_{0}^{1} \lvert u \rvert^p \ dx \right)^{1/p}
    \end{equation*}
    defines a norm.
\end{exercise}

\begin{solution}
    Following the definition in Spaces by Tom Lindstrøm, a norm is a function $\lVert \cdot \rVert: V \to \mathbb{R}$, where $V$ is a vector space, such that
    \begin{enumerate}[label=(\roman*)] % chktex 36
        \item $\lVert \boldsymbol{u} \rVert \geq 0$ with equality if and only if $\boldsymbol{u} = \boldsymbol{0}$.

        \item $\lVert \alpha \boldsymbol{u} \rVert = \lvert \alpha \rvert \lVert \boldsymbol{u} \rVert$ for all $\alpha \in \mathbb{R}$ and all $\boldsymbol{u} \in V$.

        \item (Triangle Inequality for Norms) $\lVert \boldsymbol{u} + \boldsymbol{v} \rVert \leq \lVert \boldsymbol{u} \rVert + \lVert \boldsymbol{v} \rVert$ for all $\boldsymbol{u}, \boldsymbol{v} \in V$.
    \end{enumerate}

    Positivity is clear, as $\lvert u \rvert^p \geq 0$ for all $u \in L^p(0, 1)$.
    The only way $\lVert u \rVert_p = 0$ is if $\lvert u \rvert^p = 0$.
    Homogeneity is also clear, as
    \begin{align*}
        \lVert \alpha u \rVert_p &= \left( \int_{0}^{1} \lvert \alpha u \rvert^p \ dx \right)^{1/p} \\
        &= \left( \int_{0}^{1} \lvert \alpha \rvert^p \lvert u \rvert^p \ dx \right)^{1/p} \\
        &= \lvert \alpha \rvert \left( \int_{0}^{1} \lvert u \rvert^p \ dx \right)^{1/p} \\
        &= \lvert \alpha \rvert \lVert u \rVert_p.
    \end{align*}
    The triangle inequality is a bit more involved, but we have
    \begin{align*}
        \lVert u + v \rVert_p^p &= \int_{0}^{1} \lvert u + v \rvert^p \ dx \\
        &\leq \int_{0}^{1} \left( \lvert u \rvert + \lvert v \rvert \right)^p \ dx \\
        &\leq \int_{0}^{1} \lvert u \rvert^p + \lvert v \rvert^p \ dx \\
        &= \lVert u \rVert_p^p + \lVert v \rVert_p^p,
    \end{align*}
    which implies
    \begin{equation*}
        \lVert u + v \rVert_p \leq \left( \lVert u \rVert_p^p + \lVert u \rVert_p^p \right)^{1/p} \leq \lVert u \rVert_p + \lVert u \rVert_p.
    \end{equation*}
\end{solution}

\begin{exercise}
    What is an inner product? Show that
    \begin{equation*}
        (u, v)_k = \sum_{i \leq k} \int_{\Omega} \left( \frac{\partial u}{\partial x} \right)^i \left( \frac{\partial v}{\partial x} \right)^i \ dx
    \end{equation*}
    defines an inner product.
\end{exercise}

\begin{solution}
    Again, Spaces by Tom Lindstrøm defines an inner product as a function $(\cdot, \cdot): V \times V \to \mathbb{R}$, where $V$ is a vector space, such that
    \begin{enumerate}[label=(\roman*)] % chktex 36
        \item $(\boldsymbol{u}, \boldsymbol{v}) = (\boldsymbol{v}, \boldsymbol{u})$ for all $\boldsymbol{u}, \boldsymbol{v} \in V$.

        \item $(\boldsymbol{u} + \boldsymbol{v}, \boldsymbol{w}) = (\boldsymbol{u}, \boldsymbol{w}) + (\boldsymbol{v}, \boldsymbol{w})$ for all $\boldsymbol{u}, \boldsymbol{v}, \boldsymbol{w} \in V$.

        \item $(\alpha \boldsymbol{u}, \boldsymbol{v}) = \alpha (\boldsymbol{u}, \boldsymbol{v})$ for all $\alpha \in \mathbb{R}$, $\boldsymbol{u}, \boldsymbol{v} \in V$.

        \item For all $\boldsymbol{u} \in V$, $(\boldsymbol{u}, \boldsymbol{u}) \geq 0$ with equality if and only if $\boldsymbol{u} = \boldsymbol{0}$.
    \end{enumerate}

    Symmetry is clear, as
    \begin{equation*}
        (u, v)_k
        = \sum_{i \leq k} \int_{\Omega} \left( \frac{\partial u}{\partial x} \right)^i \left( \frac{\partial v}{\partial x} \right)^i \ dx
        = \sum_{i \leq k} \int_{\Omega} \left( \frac{\partial v}{\partial x} \right)^i \left( \frac{\partial u}{\partial x} \right)^i \ dx
        = (v, u)_k.
    \end{equation*}
    Linearity in the first argument is also satisfied, as
    \begin{align*}
        (u + v, w)_k
        &= \sum_{i \leq k} \int_{\Omega} \left( \frac{\partial (u + v)}{\partial x} \right)^i \left( \frac{\partial w}{\partial x} \right)^i \ dx \\
        &= \sum_{i \leq k} \int_{\Omega} \left( \frac{\partial u}{\partial x} + \frac{\partial v}{\partial x} \right)^i \left( \frac{\partial w}{\partial x} \right)^i \ dx \\
        &= \sum_{i \leq k} \int_{\Omega} \left( \frac{\partial u}{\partial x} \right)^i \left( \frac{\partial w}{\partial x} \right)^i + \left( \frac{\partial v}{\partial x} \right)^i \left( \frac{\partial w}{\partial x} \right)^i \ dx \\
        &= \sum_{i \leq k} \int_{\Omega} \left( \frac{\partial u}{\partial x} \right)^i \left( \frac{\partial w}{\partial x} \right)^i \ dx + \sum_{i \leq k} \int_{\Omega} \left( \frac{\partial v}{\partial x} \right)^i \left( \frac{\partial w}{\partial x} \right)^i \ dx \\
        &= (u, w)_k + (v, w)_k.
    \end{align*}
    Homogeneity in the first argument is also satisfied, as
    \begin{align*}
        (\alpha u, v)_k
        &= \sum_{i \leq k} \int_{\Omega} \left( \frac{\partial (\alpha u)}{\partial x} \right)^i \left( \frac{\partial v}{\partial x} \right)^i \ dx \\
        &= \sum_{i \leq k} \int_{\Omega} \alpha \left( \frac{\partial u}{\partial x} \right)^i \left( \frac{\partial v}{\partial x} \right)^i \ dx \\
        &= \alpha \sum_{i \leq k} \int_{\Omega} \left( \frac{\partial u}{\partial x} \right)^i \left( \frac{\partial v}{\partial x} \right)^i \ dx \\
        &= \alpha (u, v)_k.
    \end{align*}
    Finally, positivity is also satisfied, as
    \begin{equation*}
        (u, u)_k
        = \sum_{i \leq k} \int_{\Omega} \left( \frac{\partial u}{\partial x} \right)^i \left( \frac{\partial u}{\partial x} \right)^i \ dx
        = \sum_{i \leq k} \int_{\Omega} \left( \frac{\partial^i u}{\partial x^i} \right)^{2} \ dx
        \geq 0.
    \end{equation*}
    $(u, u)_k = 0$ only if $\frac{\partial^i u}{\partial x^i} = 0$ for all $i \leq k$, which implies $u = 0$.
    $(u, v)_k$ is therefore an inner product.
\end{solution}

\begin{exercise}
    Compute the $H^1$ and $L^2$ norms of a random function with values in $(0, 1)$ on meshes representing the unit interval with 10, 100, and 1000 cells.
\end{exercise}

\begin{solution}
    As a random function, I choose the Bernstein polynomial $B_{5}^{10}$, which is given by
    \begin{equation*}
        B_{5}^{10}(x) = \binom{10}{5} x^5 (1 - x)^5.
    \end{equation*}
\end{solution}

\begin{exercise}
    Compute the $H^1$ and $L^2$ norms of the function $u(x) = \sin(k\pi x)$ on the unit interval analytically and compare with the values presented in Table 2.2.
\end{exercise}

\begin{solution}
    The $L^2$ norm of $u(x) = \sin(k\pi x)$ is given by
    \begin{align*}
        \lVert u \rVert_2 &=\left( \int_{0}^{1} \sin^2(k\pi x) \ dx \right)^{1/2} \\
        &=\left( \frac{1}{2} \int_{0}^{1} 1 - \cos(2k\pi x) \ dx \right)^{1/2} \\
        &=\left( \frac{1}{2} \left[ x - \frac{1}{2k\pi} \sin(2k\pi x) \right]_0^1 \right)^{1/2} \\
        &=\left( \frac{1}{2} \left( 1 - 0 \right) \right)^{1/2}
        = \frac{\sqrt{2}}{2}.
    \end{align*}
    The $H^1$ norm is given by
    \begin{align*}
        \lVert u \rVert_1 &= \left( \int_{0}^{1} \left( \frac{\partial u}{\partial x} \right)^2 + u^2 \ dx \right)^{1/2} \\
        &= \left( \int_{0}^{1} \left( k\pi \cos(k\pi x) \right)^2 + \sin^2(k\pi x) \ dx \right)^{1/2} \\
        &= \left( \int_{0}^{1} (k\pi)^2 \cos^2(k\pi x) + \sin^2(k\pi x) \ dx \right)^{1/2} \\
        &= \left( \int_{0}^{1} (k\pi)^2 \left( 1 - \sin^2(k\pi x) \right) + \sin^2(k\pi x) \ dx \right)^{1/2} \\
        &= \left( \int_{0}^{1} (k\pi)^2 + (1 - (k\pi)^2) \sin^2(k\pi x) \ dx \right)^{1/2} \\
        &= \left( (k\pi)^2 + (1 - (k\pi)^2) \int_{0}^{1} \sin^2(k\pi x) \ dx \right)^{1/2} \\
        &= \left( (k\pi)^2 + (1 - (k\pi)^2) \frac{1}{2} \right)^{1/2}
        = \sqrt{\frac{1 + (k\pi)^2}{2}}.
    \end{align*}
    The $H^1$ norm should then increase as $k$ increases, while the $L^2$ norm should remain constant, and we do indeed see this behaviour in Table 2.2.
\end{solution}

\begin{exercise}
    Compute the $H^1$ and $L^2$ norms of the hat function in Picture 2.2.
\end{exercise}

\begin{solution}
    The hat function in Picture 2.2 is given by
    \begin{equation*}
        u(x) =
        \begin{cases}
            \frac{x + 0.2}{0.2}, & x \in [-0.2, 0], \\
            \frac{0.2 - x}{0.2}, & x \in [0, 0.2], \\
            0, & \text{otherwise}.
        \end{cases}
    \end{equation*}
    The $L^2$ norm is given by
    \begin{align*}
        \lVert u \rVert_2 &= \left( \int_{0}^{1} u^2 \ dx \right)^{1/2} \\
        &= \left( \int_{-0.2}^{0} \left( \frac{x + 0.2}{0.2} \right)^2 \ dx + \int_{0}^{0.2} \left( \frac{0.2 - x}{0.2} \right)^2 \ dx \right)^{1/2} \\
        &= \left( \int_{-0.2}^{0} \left( \frac{x^2 + 0.4x + 0.04}{0.04} \right) \ dx + \int_{0}^{0.2} \left( \frac{0.04 - 0.4x + x^2}{0.04} \right) \ dx \right)^{1/2} \\
        &= \left(
            \frac{1}{0.02} \int_{0}^{0.2} x^2 - 0.4x + 0.04 \ dx
        \right)^{1/2} \\
        &= \left(
            \frac{1}{0.02} \left[ \frac{1}{3} x^3 - 0.2x^2 + 0.04x \right]_0^{0.2}
        \right)^{1/2} \\
        &= \left(
            \frac{1}{0.02} \left( \frac{1}{3} \cdot 0.008 - 0.2 \cdot 0.04 + 0.04 \cdot 0.2 \right)
        \right)^{1/2} \\
        &= \sqrt{\frac{2}{15}}
    \end{align*}

    The derivative of $u$ is given by
    \begin{equation*}
        \frac{\partial u}{\partial x} =
        \begin{cases}
            5, & x \in [-0.2, 0], \\
            -5, & x \in [0, 0.2], \\
            0 & \text{otherwise}.
        \end{cases}
    \end{equation*}
    Which gives the $H^1$ norm as
    \begin{align*}
        \lVert u \rVert_1 = \left( \lVert u \rVert_2^2 + \lvert u \rvert_1^2 \right)^{1/2}
        = \left( \frac{2}{15} + 25 \frac{2}{5} \right)^{1/2}
        = \sqrt{\frac{152}{15}}.
    \end{align*}
\end{solution}

\begin{exercise}
    Consider the following finite element function $u$ defined as
    \begin{equation*}
        u =
        \begin{cases}
            1, & x = 0.5, \\
            \frac{1}{h} x - \frac{1}{h} (0.5 - h), & x = (0.5 - h, 0.5), \\
            -\frac{1}{h} x + \frac{1}{h} (0.5 - h), & x = (0.5, 0.5 + h), \\
            0, & \text{otherwise}.
        \end{cases}
    \end{equation*}
    That is, it corresponds to the hat function in Picture 2.2, where $u(0.5) = 1$ and the hat function is zero everywhere in $(0, 0.5 - h)$ and $(0.5 + h, 1)$.
    Compute the $H^1$ and $L^2$ norms of this function analytically, and the $L^2$, $H^1$, and $H^{-1}$ norms numerically for $h = 10$, $100$, and $1000$.
\end{exercise}

\begin{solution}
    Equivalently, we can write $u$ as
    \begin{equation*}
        u =
        \begin{cases}
            1, & x = \frac{1}{2}, \\
            \frac{1}{h} x - \frac{1}{h} \left( \frac{1}{2} - h \right), & x \in \left( \frac{1}{2} - h, \frac{1}{2} \right), \\
            -\frac{1}{h} x + \frac{1}{h} \left( \frac{1}{2} - h \right), & x \in \left( \frac{1}{2}, \frac{1}{2} + h \right), \\
            0, & \text{otherwise}.
        \end{cases}
    \end{equation*}
    We begin by computing the $L^2$ norm of $u$ analytically.
    \begin{align*}
        \lVert u \rVert_2 &= \left( \int_{0}^{1} u^2 \ dx \right)^{1/2} \\
        &= \left( \int_{\frac{1}{2} - h}^{\frac{1}{2}} \left( \frac{1}{h} x - \frac{1}{h} (\frac{1}{2} - h) \right)^2 \ dx + \int_{\frac{1}{2}}^{\frac{1}{2} + h} \left( -\frac{1}{h} x + \frac{1}{h} (\frac{1}{2} - h) \right)^2 \ dx \right)^{1/2} \\
        &= \left(
            2 \int_{\frac{1}{2} - h}^{\frac{1}{2}} \left( \frac{1}{h} x - \frac{1}{h} (\frac{1}{2} - h) \right)^2 \ dx
        \right)^{1/2} \\
        &= \left(
            \frac{2}{h^2} \int_{\frac{1}{2} - h}^{\frac{1}{2}} x^2 - 2x(\frac{1}{2} - h) + (\frac{1}{2} - h)^2 \ dx
        \right)^{1/2} \\
        &= \left(
            \frac{2}{h^2} \left[ \frac{1}{3} x^3 - (\frac{1}{2} - h) x^2 + (\frac{1}{2} - h)^2 x \right]_{\frac{1}{2} - h}^{\frac{1}{2}}
        \right)^{1/2} \\
        &= \frac{\sqrt{2}}{h} \Bigg(
            \left[
                \frac{1}{3} \cdot \frac{1}{8}
                - (\frac{1}{2} - h) \cdot \frac{1}{4}
                + (\frac{1}{2} - h)^2 \cdot \frac{1}{2}
            \right] \\
            &\quad - \left[
                \frac{1}{3} \cdot \left( \frac{1}{2} - h \right)^3
                - (\frac{1}{2} - h) \cdot \left( \frac{1}{2} - h \right)^2
                + (\frac{1}{2} - h)^2 \cdot \left( \frac{1}{2} - h \right)
            \right]
        \Bigg)^{1/2} \\
        &= \frac{\sqrt{2}}{h}\left(
            \frac{1}{24}
            - \frac{1}{8} + \frac{h}{4}
            + \frac{1}{8} - \frac{h}{2} + \frac{h^2}{2}
            - \frac{1}{3} \left( \frac{1}{2} - h \right)^3
        \right)^{1/2}
    \end{align*}

    % I'm beginning to start to regret not doing in generally in the first place\dots
    % Without further ado, lets compute the $L^2$ norm of $u$ analytically.
    % \begin{align*}
    %     \lVert u \rVert_2 &= \left( \int_{0}^{1} u^2 \ dx \right)^{1/2} \\
    %     &= \left( \int_{0.5 - h}^{0.5} \left( \frac{1}{h} x - \frac{1}{h} (0.5 - h) \right)^2 \ dx + \int_{0.5}^{0.5 + h} \left( -\frac{1}{h} x + \frac{1}{h} (0.5 - h) \right)^2 \ dx \right)^{1/2} \\
    %     &= \left(
    %         2 \int_{0.5 - h}^{0.5} \left( \frac{1}{h} x - \frac{1}{h} (0.5 - h) \right)^2 \ dx
    %     \right)^{1/2} \\
    %     &= \left(
    %         \frac{2}{h^2} \int_{0.5 - h}^{0.5} x^2 - 2x(0.5 - h) + (0.5 - h)^2 \ dx
    %     \right)^{1/2} \\
    %     &= \left(
    %         \frac{2}{h^2} \left[ \frac{1}{3} x^3 - (0.5 - h) x^2 + (0.5 - h)^2 x \right]_{0.5 - h}^{0.5}
    %     \right)^{1/2} \\
    %     &= \left(
    %         \frac{2}{h^2} \left( \frac{1}{3} \cdot 0.125 - (0.5 - h) \cdot 0.25 + (0.5 - h)^2 \cdot 0.5 \right)
    %     \right)^{1/2} \\
    %     &= \left(
    %         \frac{2}{h^2} \left( \frac{1}{24} - 0.125(0.5 - h) + 0.25(0.5 - h)^2 \right)
    %     \right)^{1/2} \\
    %     &= \left(
    %         \frac{2}{h^2} \left( \frac{1}{24} - 0.125 \cdot 0.5 + 0.25 \cdot 0.25 \right)
    %     \right)^{1/2} \\
    % \end{align*}
    Opting to instead use Wolfram Alpha to solve the integral, we find that
    \begin{equation*}
        \lVert u \rVert_2 = \sqrt{\frac{2h}{3}}.
    \end{equation*}
    The $H^1$ semi-norm is hopefully simpler to compute, and is given by
    \begin{align*}
        \lvert u \rvert_1 &= \left( \int_{0}^{1} \left( \frac{\partial u}{\partial x} \right)^2 \ dx \right)^{1/2} \\
        &= \left( \int_{0.5 - h}^{0.5} \frac{1}{h^2} \ dx + \int_{0.5}^{0.5 + h} \frac{1}{h^2} \ dx \right)^{1/2} \\
        &= \left( \frac{1}{h^2} \left( 0.5 - (0.5 - h) \right) + \frac{1}{h^2} \left( 0.5 + h - 0.5 \right) \right)^{1/2} \\
        &= \left( \frac{2h}{h^2} \right)^{1/2} = \sqrt{\frac{2}{h}}.
    \end{align*}
    This gives us the $H^1$ norm as
    \begin{equation*}
        \lVert u \rVert_1 = \sqrt{\frac{2}{h} + \frac{2h}{3}} = \sqrt{\frac{6 + 2h^2}{3h}}.
    \end{equation*}
\end{solution}